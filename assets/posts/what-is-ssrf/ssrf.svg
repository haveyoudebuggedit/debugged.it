<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="385px" preserveAspectRatio="none" style="width:666px;height:385px;" version="1.1" viewBox="0 0 666 385" width="666px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="14.1328" style="stroke: #AAAAAA; stroke-width: 1.0;" width="10" x="363.5" y="304.8281"/><rect fill="#FFFFFF" height="72.2656" style="stroke: #AAAAAA; stroke-width: 1.0;" width="10" x="582.5" y="275.6953"/><line style="stroke: #AAAAAA; stroke-width: 1.0;" x1="54" x2="54" y1="82.2969" y2="202.5625"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="54" x2="54" y1="202.5625" y2="230.5625"/><line style="stroke: #AAAAAA; stroke-width: 1.0;" x1="54" x2="54" y1="230.5625" y2="373.0938"/><line style="stroke: #AAAAAA; stroke-width: 1.0;" x1="368.5" x2="368.5" y1="82.2969" y2="202.5625"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="368.5" x2="368.5" y1="202.5625" y2="230.5625"/><line style="stroke: #AAAAAA; stroke-width: 1.0;" x1="368.5" x2="368.5" y1="230.5625" y2="373.0938"/><line style="stroke: #AAAAAA; stroke-width: 1.0;" x1="587" x2="587" y1="82.2969" y2="202.5625"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="587" x2="587" y1="202.5625" y2="230.5625"/><line style="stroke: #AAAAAA; stroke-width: 1.0;" x1="587" x2="587" y1="230.5625" y2="373.0938"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="23" y="78.9951">Attacker</text><ellipse cx="54.5" cy="13" fill="#FFFFFF" rx="8" ry="8" style="stroke: #000000; stroke-width: 2.0;"/><path d="M54.5,21 L54.5,48 M41.5,29 L67.5,29 M54.5,48 L41.5,63 M54.5,48 L67.5,63 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="313.5" y="78.9951">Internal service</text><path d="M350.5,30 C350.5,20 368.5,20 368.5,20 C368.5,20 386.5,20 386.5,30 L386.5,56 C386.5,66 368.5,66 368.5,66 C368.5,66 350.5,66 350.5,56 L350.5,30 " fill="#FEFECE" style="stroke: #000000; stroke-width: 1.5;"/><path d="M350.5,30 C350.5,40 368.5,40 368.5,40 C368.5,40 386.5,40 386.5,30 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="530" y="78.9951">Web application</text><ellipse cx="587.5" cy="50" fill="#FEFECE" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="583.5,38,589.5,33,587.5,38,589.5,43,583.5,38" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FFFFFF" height="14.1328" style="stroke: #AAAAAA; stroke-width: 1.0;" width="10" x="363.5" y="304.8281"/><rect fill="#FFFFFF" height="72.2656" style="stroke: #AAAAAA; stroke-width: 1.0;" width="10" x="582.5" y="275.6953"/><rect fill="none" height="96.2656" style="stroke: #000000; stroke-width: 1.0;" width="420.5" x="13" y="99.2969"/><polygon fill="#EEEEEE" points="13,99.2969,154,99.2969,154,106.2969,144,116.2969,13,116.2969,13,99.2969" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="28" y="112.3638">Direct attack</text><line style="stroke: #03A87C; stroke-width: 2.0;" x1="350.5" x2="360.5" y1="157.4297" y2="167.4297"/><line style="stroke: #03A87C; stroke-width: 2.0;" x1="350.5" x2="360.5" y1="167.4297" y2="157.4297"/><line style="stroke: #03A87C; stroke-width: 1.0;" x1="54.5" x2="355.5" y1="162.4297" y2="162.4297"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="290" x="61.5" y="157.4966">A direct attack does not work due to a firewall</text><rect fill="none" height="118.5313" style="stroke: #000000; stroke-width: 1.0;" width="642" x="13" y="237.5625"/><polygon fill="#EEEEEE" points="13,237.5625,95,237.5625,95,244.5625,85,254.5625,13,254.5625,13,237.5625" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="28" y="250.6294">SSRF</text><polygon fill="#03A87C" points="570.5,271.6953,580.5,275.6953,570.5,279.6953,574.5,275.6953" style="stroke: #03A87C; stroke-width: 1.0;"/><line style="stroke: #03A87C; stroke-width: 1.0;" x1="54.5" x2="576.5" y1="275.6953" y2="275.6953"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="61.5" y="270.7622">Tricky request to the application</text><polygon fill="#03A87C" points="384.5,300.8281,374.5,304.8281,384.5,308.8281,380.5,304.8281" style="stroke: #03A87C; stroke-width: 1.0;"/><line style="stroke: #03A87C; stroke-width: 1.0;" x1="378.5" x2="581.5" y1="304.8281" y2="304.8281"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="390.5" y="299.895">Request to an internal service</text><polygon fill="#03A87C" points="570.5,314.9609,580.5,318.9609,570.5,322.9609,574.5,318.9609" style="stroke: #03A87C; stroke-width: 1.0;"/><line style="stroke: #03A87C; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="368.5" x2="576.5" y1="318.9609" y2="318.9609"/><polygon fill="#03A87C" points="65.5,343.9609,55.5,347.9609,65.5,351.9609,61.5,347.9609" style="stroke: #03A87C; stroke-width: 1.0;"/><line style="stroke: #03A87C; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="59.5" x2="586.5" y1="347.9609" y2="347.9609"/><text fill="#000000" font-family="Menlo,Monaco,Consolas,&quot;Liberation Mono&quot;,&quot;Courier New&quot;,monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="71.5" y="343.0278">Data from internal service is returned to attacker</text><!--
@startuml

skinparam backgroundColor transparent
skinparam shadowing false
skinparam arrowColor gray
skinparam defaultFontName Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace

skinparam class {
    arrowColor #03a87c
    borderColor #aaaaaa
    backgroundColor #fafafa
}

skinparam activity {
    arrowColor #03a87c
    borderColor #aaaaaa
    backgroundColor transparent
    fontSize 12
}

skinparam sequence {
    actorBorderColor #000000
    actorBackgroundColor transparent
    participantBorderColor #aaaaaa
    participantBackgroundColor transparent
    groupBorderThickness 1
    arrowColor #03a87c
    borderColor #aaaaaa
    backgroundColor transparent
    boxBorderColor #aaaaaa
    boxBackgroundColor transparent
    boxFontColor #000000
    lifeLineBorderColor #aaaaaa
}

skinparam note {
    borderColor #03a87c
    backgroundColor transparent
}
hide footbox
actor Attacker
database "Internal service"
control "Web application"
group Direct attack
   |||
   Attacker ->x "Internal service": A direct attack does not work due to a firewall
   ||| 
end
...
group SSRF
   Attacker -> "Web application": Tricky request to the application
   activate "Web application"
   "Web application" -> "Internal service": Request to an internal service
   activate "Internal service"
   "Internal service" - -> "Web application"
   deactivate "Internal service"
   "Web application" - -> Attacker: Data from internal service is returned to attacker
   deactivate "Web application"
end

@enduml

PlantUML version 1.2017.15(Mon Jul 03 16:45:34 UTC 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-post-Ubuntu-2ubuntu218.04
Operating System: Linux
OS Version: 4.15.0-1077-aws
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>